编程之美早报 之
【每周一波：老杨的周记】
今天老杨给大家分享：多次编码中的坑
事情经过:
1.本周二我被经理外派出差渝北金开大道，任务解决那边的一个数据库乱码异常
2.那边的负责人描述：数据库原是utf8编码，他为了兼容emoji表情，改为utf8mb4,之后出现编码异常

分析第一步：编码的关系
数据库是mysql
在mysql中，utf8mb4是utf8的子集，之间是可以切换的
同时：出现编码异常的只有中文
如果是emoji表情编码乱码还可以解释，为啥是中文乱码
中文在utf8mb4和utf8中同为三个字节
因为是线上环境，数据库不能动
备份数据，转存到备用测试服务器
测试存储中文字符
一切正常
检查正式服务器和测试服务器的Tomcat配置，数据库链接url，一模一样
难道是打包的问题？
检查eclipse的编码，还是utf8,检测分割符，是unix的分隔符，完全符合linux的环境
重新打个包传到测试服务器，经测试乱码
好吧，数据库接到测试服务器，本地开启调试试试
最后我问了一句那边的负责人：你发布最后一个版本时写了代码没
他说了写了的。然后把代码翻给我看
web.xml中约定了全文编码为utf8
他在代码中又处理一次编码
然而就是这个多余的编码
a.getBytes(),"UTF-8"
getBytes不传编码，会按照ISO-8859-1来解析，再转回UTF8
ISO-8859-1是java默认的编码方式
把他的代码注释传到测试服，正常了
再检查环境的过程中，我要求他打印出sql执行情况过
console只打印sql的配置：http://www.zuidaima.com/blog/2998561964854272.htm
需要检查sql执行情况时，写个log4j.properties传到服务器上，重启一下就可以看到了，不需要了删除即可
我的一些分享： http://www.zuidaima.com/user/1550463812077728/blog.htm http://www.zuidaima.com/user/1550463812077728/share.htm
这个问题大家应该也会经常遇到：http://www.zuidaima.com/blog/3082216023231488.htm

泥瓦匠：体验技术工程师 - 我喜欢这句话。不要严格分技术，你有时间也可以搞硬件，但最好还是跟着公司业务走。比如我搞前端 搞得不深，做一些完善当前业务的监控。很有意思
谁不想做技术大牛，演讲，社区里一群粉丝（要付出辛苦劳动滴）
要付出 + 时间 + 一点点运气 还是要付出努力。和踏实。
如果你找工作只是冲着钱去的话，首先你就不应该是个工程师。
我承认我不是一个合格的 工程师 ，我有兴趣也对钱更有兴趣。但钱想 当工程师挣，你和搬砖真没区别。
挣钱 要去想想挣钱的路，工程师是我的切入口 罢了